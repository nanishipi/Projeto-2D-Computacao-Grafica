<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projeto 1 - Jogo</title>
</head>
<body>
    
    <canvas id="myCanvas" style="width: 100%;">
		Your browser does not support HTML5 Canvas.
	</canvas>

    

    <script>
        const canvas = document.querySelector("#myCanvas");
        canvas.width = innerWidth;
        canvas.height = innerHeight;
        const ctx = canvas.getContext("2d");
        let backgroundImage = new Image()
        backgroundImage.src = 'images/backgroundImage.png'
        const W = canvas.width
        const H = canvas.height
        let spriteFramecounter = 0
        let spriteStopFrames = 0
        let spriteTestImage = new Image()
        spriteTestImage.src = 'images/characterRunning.png'
        let spriteStop = new Image()
        spriteStop.src="images/characterStop.png"
        let spriteTestImage2 = new Image()
        spriteTestImage2.src = 'images/characterRunning 2.png'
        let spriteMovesX = 0

        class Ball{
            constructor(x,y,r,c,v){
                this.xBall = x; //x posição inicial
                this.yBall = y; //y posição inicial
                this.rBall = r; //raio da bola
                this.cBall = c; //cor da bola 
                this.vBall = v; //velocidade
            }

            draw(){
                ctx.fillStyle = this.c;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.r, 0, 2 * Math.PI);
                ctx.fill;
            }

            update(){

            }
        }

        class Player{
            constructor(x,y,v){
                this.xPlayer = x; //x posição inicial
                this.yPlayer = y; //y posição inicial
                this.vPlayer = v; //velocidade de andamento
            }

            draw(){

            }

            update(){

            }
        }

        class Harpoon{
            constructor(){
                this.xHarpoon = x; //x posição inicial
                this.yHarpoon = y; //y posição inicial
                this.vHarpoon = v; //velociade do arpão
            }

            draw(){

            }

            update(){
                
            }
        }

        let ball = new Array();

        function newBall(){

        }

        //Criação da personagem
        let personagem = new Image();
            personagem.src = "images/SpriteTestImage.png"
        let moveRight = false
        let moveLeft = false;
        let characterCounter1 = 0;
        //Controlador de comandos de movimento
        function arrowPressed(e){
            if(e.key == "ArrowRight"){
                moveRight = true;
                //console.log("clicou")
            }
            if(e.key == "ArrowLeft"){
                moveLeft = true;
                //console.log("clicou")
            }
        }

        function arrowReleased(e){
            if(e.key == "ArrowRight"){
                //console.log("Largou")
                moveRight = false;
            }
            if (e.key == "ArrowLeft"){
                //console.log("Largou");
                moveLeft = false;
            }
        }

        //Controladores de listners
        window.addEventListener("keydown", arrowPressed)
        window.addEventListener("keyup", arrowReleased)


        backgroundImage.onload = function(){
                render();
                window.setInterval(moveTest, 1000/10)
        }
        
        //Teste sprite move
            function moveTest(){
                if(moveRight){
                spriteFramecounter++
                spriteMovesX++;
                    if(spriteFramecounter == 8){
                        spriteFramecounter = 0
                        
                    }         
                    }
                    else{
                        spriteStopFrames++
                        if(spriteStopFrames == 8){
                            spriteStopFrames = 0
                        }
                    ctx.drawImage(spriteStop, spriteStopFrames * 501, 0, 501, 526, spriteMovesX * 40 + W / 2 - 100, H / 2 + 150, 108, 108)
                    console.log("ELESE")
                    }

                if (moveLeft){
                    spriteFramecounter++
                    spriteMovesX--;
                        if(spriteFramecounter == 8){
                            spriteFramecounter = 0
                        }
                }else{
                    spriteStopFrames++
                    if(spriteStopFrames == 8){
                        spriteStopFrames = 0
                    }
                    ctx.drawImage(spriteStop, spriteStopFrames * 501, 0, 501, 526, spriteMovesX * 40 + W / 2 - 100, H / 2 + 150, 108, 108)
                }

            }

        //Fim teste sprite move

        //ctx.drawImage(spriteStop, spriteStopFrames * 501, 0, 501, 526, spriteMovesX * 20 + W / 2 - 100, H / 2 + 150, 108, 108)
         

        function render(){
            //console.log("Funcao")
            ctx.clearRect(0,0,W,H)
            ctx.drawImage(backgroundImage,0,0,W,H)
            
            if(!moveRight && !moveLeft){
                ctx.drawImage(spriteStop, spriteStopFrames * 501, 0, 501, 526, spriteMovesX * 40 + W / 2 - 100, H / 2 + 150, 108, 108)

            }else if (moveRight){
                ctx.drawImage(spriteTestImage, spriteFramecounter * 500, 0, 517, 517, spriteMovesX * 40 + W / 2 - 100, H / 2 + 150, 100, 100)
            }
            else{
                ctx.drawImage(spriteTestImage2, spriteFramecounter * 500, 0, 517, 517, spriteMovesX * 40 + W / 2 - 100, H / 2 + 150, 100, 100)
            }
           //Controlador de personagem

            //console.log(moveRight)
            //ctx.drawImage(personagem,characterCounter1 * 3 + W / 2 - 100, H / 2 + 150,100,100)
            ctx.fillRect(0,0,W / 50, H );
            ctx.fillRect(W - W/ 50,0,W / 50, H );
            ctx.fillRect(0,0,W, H / 30 );
            ctx.fillRect(0,H - H / 30,W, H / 30 );
            window.requestAnimationFrame(render)
        }
    </script>
</body>
</html>
